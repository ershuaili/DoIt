<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{commons::head(~{::title})}">
    <title>DoIt-Day</title>
</head>

<body class="hold-transition dark-mode sidebar-mini layout-fixed layout-navbar-fixed layout-footer-fixed">
<div class="wrapper">
    <!-- 顶部导航栏 -->
    <nav th:replace="commons::commonNav(day)"></nav>
    <!-- 左侧导航栏 -->
    <aside th:replace="commons::commonMenu(day)"></aside>

    <!-- 中间内容 -->
    <div class="content-wrapper">
        <!-- Main content -->
        <section class="content">
            <div class="container-fluid">
                <!-- /.row -->
                <div class="row">
                    <!-- 任务 -->
                    <div class="col-8">
                        <form method="post" th:action="@{/taskInput}" th:object="${task}">
                            <!--输入框-->
                            <label for="taskName"></label>
                            <input class="form-control input-lg" id="taskName" name="taskName" placeholder="添加任务"
                                   type="text">
                        </form>
                        <!--选择框-->
                        <div id="tasks" th:each="task:${tasks}">
                            <p></p>
                            <i th:class="${task.isFinish == true?'bi bi-check-circle':'bi bi-circle'}">&nbsp;</i>
                            <a style="color: #f9f9f9" th:href="${task.id}" th:text="${task.taskName}"></a>

                            <button id="name" th:text="${task.taskName}" th:value="${task.id}">测试</button>
                        </div>
                    </div>
                    <!-- 步骤 -->
                    <div class="col-4">
                        <form method="post" th:action="@{/stepInput}" th:object="${step}">
                            <!--输入框-->
                            <label for="step"></label>
                            <input class="form-control input-lg" id="step" name="content" placeholder="添加步骤"
                                   type="text">
                        </form>

                        <!--选择框-->
                        <div id="steps"></div>
                    </div>
                </div>
                <!-- /.row -->
            </div>
        </section>
        <!-- Main content -->
    </div>
    <!--/ 中间内容 -->
</div>

<div th:replace="commons::commonScript"></div>
<script th:inline="javascript">

    let tasks = document.getElementById("tasks");
    let steps = document.getElementById("steps")
    // 插入节点
    // tasks.innerHTML='a';
    // 追加节点
    tasks.appendChild(steps);
    // 创建一个新的节点
    // let newP = document.createElement('p');
    // newP.id='tasks'

    $(function () {
        $("").onpageshow(function () {
            $.ajax({
                // 请求路径
                url: "/d",
                type: 'post',
                // 方法回调将#name的值赋值给id
                data: {"id": $("#name").val()},
                success: function (data) {
                    // 拿到数据后执行的方法
                    console.log(data);
                    let html = "";
                    for (let i = 0; i < data.length; i++) {
                        html += "<br>" + "<i class=\"bi bi-check-circle\"></i>" + "&nbsp;" + data[i].content + "<br>"
                    }
                    $("#steps").html(html);
                }
            })
        })
    })

    // 步骤
    $(function () {
        $("#name").click(function () {
            $.ajax({
                // 请求路径
                url: "/d",
                type: 'post',
                // 方法回调将#name的值赋值给id
                data: {"id": $("#name").val()},
                success: function (data) {
                    // 拿到数据后执行的方法
                    console.log(data);
                    let html = "";
                    for (let i = 0; i < data.length; i++) {
                        html += "<br>" + "<i class=\"bi bi-check-circle\"></i>" + "&nbsp;" + data[i].content + "<br>"
                    }
                    $("#steps").html(html);
                }
            })
        })
    });
</script>
</body>
</html>
